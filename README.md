
# Neuro-Link (åè¥¿ç¥ç»ä¸“ç—…AIæ•°å­—åŒ»é™¢)

## 1. é¡¹ç›®æ„¿æ™¯ (Project Vision)
æœ¬é¡¹ç›®è‡´åŠ›äºæ„å»ºä¸€ä¸ª**ç¬¦åˆåè¥¿åŒ»é™¢ç¥ç»å†…ç§‘ä¸´åºŠæ ‡å‡† (CRF)** çš„ C ç«¯æ•°å­—åŒ»ç–—æœåŠ¡å¹³å°ã€‚
æ ¸å¿ƒç†å¿µï¼š**â€œæç®€å‡†å…¥ï¼Œä¸“ä¸šåˆ†æµï¼Œå…¨ç—…ç¨‹é—­ç¯â€**ã€‚
ç³»ç»Ÿé›†æˆäº† **AI CDSSï¼ˆä¸´åºŠå†³ç­–æ”¯æŒç³»ç»Ÿï¼‰**ã€**å¤šè§’è‰²è´¦æˆ·ä½“ç³» (RBAC)**ã€**æ•°å­—ç–—æ³• (TMT-B/AVLT)** ä»¥åŠ **IoT ç¡¬ä»¶ç”Ÿæ€**ï¼Œä¸ºåå¤´ç—›ã€ç™«ç—«åŠè®¤çŸ¥éšœç¢æ‚£è€…æä¾›å…¨ç”Ÿå‘½å‘¨æœŸçš„æ…¢ç—…ç®¡ç†æœåŠ¡ã€‚

---

## 2. ä»£ç æ¶æ„ä¸ç›®å½•ç´¢å¼• (Architecture & Source Map)

é¡¹ç›®é‡‡ç”¨ **Feature-based** ä¸ **Layer-based** æ··åˆæ¶æ„ï¼Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ç”± **é…ç½®å¼•æ“ (Config Engine)** é©±åŠ¨ã€‚

### ğŸ“‚ Root & Core (æ ¹ç›®å½•ä¸æ ¸å¿ƒ)
*   **`App.tsx`**: åº”ç”¨ä¸»å…¥å£ã€‚è´Ÿè´£å…¨å±€è·¯ç”±åˆ†å‘ (`currentView` state)ã€æ·±å±‚é“¾æ¥ç›‘å¬ã€ç¦»çº¿çŠ¶æ€æ£€æµ‹åŠå…¨å±€ SOS ç›‘æ§ã€‚
*   **`types/index.ts`**: **ç±»å‹å®šä¹‰ä¸­å¿ƒ (SSOT)**ã€‚åŒ…å« `User`, `DiseaseType`, `MedicalOrder`, `FollowUpSession` åŠè¯¦ç»†çš„ç—…å†ç»“æ„å®šä¹‰ã€‚
*   **`metadata.json`**: åº”ç”¨æƒé™ä¸å…ƒæ•°æ®é…ç½®ã€‚

### ğŸ“‚ Pages (é¡µé¢è§†å›¾å±‚)
> ä½äº `pages/` ç›®å½•ï¼Œä½œä¸ºè·¯ç”±çš„ä¸€çº§å…¥å£ï¼Œè´Ÿè´£ç»„è£…ç»„ä»¶å¹¶å¤„ç†é¡¶å±‚é¡µé¢é€»è¾‘ã€‚
*   **`LoginView.tsx`**: **ç»Ÿä¸€ç™»å½•å…¥å£**ã€‚æ”¯æŒæ‰‹æœº/å¾®ä¿¡/æ”¯ä»˜å®ä¸€é”®ç™»å½•ï¼Œé›†æˆéªŒè¯ç å€’è®¡æ—¶ä¸é”™è¯¯åé¦ˆã€‚
*   **`HomeView.tsx`**: **ç»¼åˆä»ªè¡¨ç›˜**ã€‚åŒ…å«å¥åº·åˆ†æ°´æ³¢çƒã€IoT è®¾å¤‡çŠ¶æ€ç›‘æ§ã€åŒ»å˜±ä»»åŠ¡å¡ç‰‡ (Medical Tasks)ã€‚
*   **`ChatView.tsx`**: **AI é—®è¯Šä¸»ç•Œé¢**ã€‚
    *   é›†æˆ `geminiService` å®ç°å¤šè½®é—®è¯Šã€‚
    *   åŒ…å«åŠ¨æ€è¿›åº¦æ¡ã€å…³é”®è¯ç†”æ–­æœºåˆ¶ (Circuit Breaker) ä¸è½¯æ€§ä»˜è´¹å¼•å¯¼ã€‚
*   **`AssessmentView.tsx`**: **é€šç”¨é‡è¡¨æµ‹è¯„å¼•æ“**ã€‚
    *   **æ ¸å¿ƒé€»è¾‘**: è§£æ `config/forms/*.ts` é…ç½®æ–‡ä»¶ï¼ŒåŠ¨æ€æ¸²æŸ“è¡¨å• (å•é€‰/å¤šé€‰/å¡«ç©º/å€’è®¡æ—¶æŒ‚èµ·)ã€‚
    *   æ”¯æŒ AVLT-H å»¶æ—¶æŒ‚èµ·ã€DST å€’èƒŒæµ‹è¯•åŠ AES æ•°æ®åŠ å¯†ã€‚
*   **`ReportView.tsx`**: **è¯Šæ–­æŠ¥å‘Š**ã€‚
    *   é›†æˆ CSI (ä¸´åºŠç¨³å®šæ€§) ç®—æ³•ã€‚
    *   æ¸²æŸ“çº¢/é»„/ç»¿åˆ†çº§æŠ¥å‘Šï¼Œæ”¯æŒ Chart.js è¶‹åŠ¿å›¾ä¸æ‰“å°æ¨¡å¼ã€‚
*   **`ProfileView.tsx`**: **ä¸ªäººä¸­å¿ƒ**ã€‚é›†æˆäº†å…¨ç—…ç¨‹ç®¡ç†è½´ (Journey Timeline)ã€è§’è‰²åˆ‡æ¢ã€ç¡¬ä»¶ç»­è´¹ã€‚

### ğŸ“‚ Config Engine (ä¸´åºŠè¡¨å•é…ç½®å¼•æ“)
> ä½äº `config/`ï¼Œæ˜¯åŒ»å­¦é€»è¾‘çš„æ ¸å¿ƒé©±åŠ¨æºï¼Œå®ç° CRF æ ‡å‡†çš„ä½ä»£ç åŒ–ã€‚
*   **`DiseaseContextConfig.ts`**: ç—…ç§ä¸Šä¸‹æ–‡é…ç½® (AI äººè®¾ã€é˜ˆå€¼ã€æ¨èå·¥å…·)ã€‚
*   **`ScaleDefinitions.ts`**: ç®€æ˜“é‡è¡¨å®šä¹‰ (MIDAS, QOLIE-31)ã€‚
*   **`triage_config.ts`**: AI åˆ†è¯Šå†³ç­–æ ‘é…ç½®ã€‚
*   **ğŸ“‚ forms/** (å¤æ‚ä¸´åºŠè¡¨å•é…ç½®):
    *   **ç™«ç—«**: `epilepsy_v0_config.ts` (åŸºçº¿), `epilepsy_followup_configs.ts` (V1-V5 éšè®¿).
    *   **è®¤çŸ¥ (AD)**:
        *   `cognitive_assessment_config.ts` (ç»¼åˆå¥—ä»¶)
        *   `cognitive_mmse_config.ts` (MMSE)
        *   `cognitive_moca_config.ts` (MoCA å«ç«‹æ–¹ä½“ä¸Šä¼ )
        *   `cognitive_adl_config.ts` (ADL/IADL)
        *   `cognitive_cdr_config.ts` (CDR åŒç›²ä¸»æ§)
        *   `cognitive_cdr_subject_config.ts` (CDR å—è¯•è€…å·)
        *   `cognitive_cdr_informant_config.ts` (CDR çŸ¥æƒ…è€…å·)
        *   `cognitive_avlth_config.ts` (AVLT-H å¬è§‰è¯è¯­å­¦ä¹ )
        *   `cognitive_dst_config.ts` (DST æ•°å­—å¹¿åº¦å€’èƒŒ)

### ğŸ“‚ Components (ç»„ä»¶å±‚)

#### ğŸ§© Common (é€šç”¨åŸå­ç»„ä»¶)
> ä½äº `components/common/`
*   **`Button.tsx`**: å°è£…äº† Ant Design é£æ ¼çš„äº¤äº’æŒ‰é’® (Primary/Outline/Ghost)ï¼Œé€‚é…é€‚è€æ¨¡å¼ã€‚
*   **`Layout.tsx`**: æ ‡å‡†é¡µé¢å®¹å™¨ï¼Œå¤„ç†å®‰å…¨åŒº (Safe Area) ä¸å¯¼èˆªæ ã€‚
*   **`BottomNav.tsx`**: åº•éƒ¨å…¨å±€å¯¼èˆªæ ã€‚

#### ğŸ’¼ Business (ä¸šåŠ¡æ ¸å¿ƒç»„ä»¶)
> ä½äº `components/business/`ï¼Œå°è£…ç‰¹å®šåŒ»å­¦/å•†ä¸šè§„åˆ™ã€‚
*   **`headache/`**: `DigitalPrescription.tsx` (æ•°å­—å¤„æ–¹/MOHé¢„è­¦), `NonDrugToolkit.tsx` (éè¯ç‰©å¹²é¢„).
*   **`epilepsy/`**: `WaveMonitor.tsx` (60FPS è„‘ç”µæ³¢å½¢æ¸²æŸ“/å¼‚å¸¸æ£€æµ‹).
*   **`payment/`**: `PaywallModal.tsx` (é€šç”¨æ”¯ä»˜å¢™ï¼Œå«ä¼˜æƒ åˆ¸é€»è¾‘).
*   **`profile/`**: `HardwareStatus.tsx` (HaaS è®¾å¤‡çŠ¶æ€/ç»­è´¹).
*   **`ReferralSystem.tsx`**: **è½¬è¯Šé€šè¡Œè¯**ã€‚ç”Ÿæˆå« AES åŠ å¯†å…¨é‡ç—…å†çš„äºŒç»´ç ã€‚

#### ğŸ“¦ Features (åŠŸèƒ½æ¨¡å—)
> ä½äº `components/`
*   **`CognitiveGames.tsx`**: åŸºç¡€è®¤çŸ¥è®­ç»ƒ (è§†è§‰è®°å¿†/èˆ’å°”ç‰¹æ–¹æ ¼)ã€‚
*   **`TMTBGame.tsx`**: **TMT-B è¿çº¿æµ‹è¯•**ã€‚Canvas å®ç°ï¼ŒåŒ…å« 25 ç‚¹é€»è¾‘æ ¡éªŒä¸è®¡æ—¶ç†”æ–­ã€‚
*   **`InteractiveMMSE.tsx`**: äº¤äº’å¼ MMSE ç­›æŸ¥ç»„ä»¶ã€‚
*   **`HealthServices.tsx`**: ä¸“ç—…æœåŠ¡è¯¦æƒ…é¡µå®¹å™¨ã€‚
*   **`ServiceMarketplace.tsx`**: æœåŠ¡å•†åŸä¸ HaaS ç§Ÿèµæ”¶é“¶å°ã€‚
*   **`RoleManager.tsx` / `RoleSelectionModal.tsx`**: RBAC è§’è‰²åˆ‡æ¢ä¸ç»‘å®šã€‚
*   **`PrivacyPanel.tsx`**: æ•°æ®éšç§ä¸å…±äº«èŒƒå›´è®¾ç½®ã€‚
*   **`GlobalSOS.tsx`**: ç³»ç»Ÿçº§çº¢è‰²è­¦æŠ¥è¦†ç›–å±‚ (Web Audio + Vibration)ã€‚

### ğŸ“‚ Logic Layer (é€»è¾‘æœåŠ¡å±‚)
*   **`context/AppContext.tsx`**: **å…¨å±€çŠ¶æ€æœº**ã€‚ç®¡ç†ç”¨æˆ·é‰´æƒã€éšè®¿æ—¥ç¨‹ (V1-V5)ã€åŒ»å˜±ä»»åŠ¡é˜Ÿåˆ—ã€‚
*   **`context/ToastContext.tsx`**: å…¨å±€è½»æç¤ºæœåŠ¡ã€‚
*   **`services/geminiService.ts`**: **AI CDSS æ ¸å¿ƒ (Mock)**ã€‚NLP æ„å›¾è¯†åˆ«ã€OCR åŒ–éªŒå•è¯†åˆ«ã€‚
*   **`utils/scoringEngine.ts`**: **åŒ»å­¦è¯„åˆ†å¼•æ“**ã€‚
    *   å®ç° **CDR (Clinical Dementia Rating)** åŒç›²åŠ æƒç®—æ³•ã€‚
    *   å®ç° MoCA å—æ•™è‚²å¹´é™ä¿®æ­£ã€ADL ä¾èµ–åº¦åˆ†çº§ã€‚
*   **`hooks/`**:
    *   `useRole.ts`: RBAC æƒé™æ§åˆ¶ (Patient/Family/Doctor)ã€‚
    *   `useIoTSimulation.ts`: IoT æ•°æ®æµæ¨¡æ‹Ÿ (å¿ƒç‡/è·Œå€’/ç¦»çº¿æ£€æµ‹)ã€‚
    *   `usePayment.ts`: SKU å®šä¹‰ä¸è®¡è´¹é€»è¾‘ã€‚
    *   `useLBS.ts`: åœ°ç†ä½ç½®æœåŠ¡ (Mock)ã€‚

---

## 3. æ ¸å¿ƒä¸šåŠ¡æµç¨‹ (Key Workflows)

### 3.1 æç®€ç™»å½•ä¸é—®è¯Š (Unified Auth & Triage)
1.  **ç”¨æˆ·è¿›å…¥**: `LoginView` ç™»å½•ã€‚
2.  **AI æ¥è¯Š**: `ChatView` åˆå§‹åŒ–ï¼ŒåŸºäº `triage_config.ts` è¿›è¡Œå†³ç­–æ ‘é—®è¯Šã€‚
3.  **ç†”æ–­æœºåˆ¶**: æ£€æµ‹åˆ°â€œè‡ªæ€/æ˜è¿·â€ç­‰å…³é”®è¯ï¼Œ`ChatView` ç«‹å³é”å®šå¹¶è§¦å‘äººå·¥ä»‹å…¥ UIã€‚

### 3.2 å¤æ‚é‡è¡¨æµ‹è¯„ (Clinical Assessment)
1.  **å¼•æ“å¯åŠ¨**: `AssessmentView` åŠ è½½å¯¹åº”ç—…ç§çš„ JSON é…ç½® (å¦‚ `cognitive_assessment_config`)ã€‚
2.  **åŠ¨æ€æ¸²æŸ“**: é€’å½’æ¸²æŸ“ `FormRenderer`ï¼Œå¤„ç†ä¾èµ–æ˜¾ç¤º (`visibleIf`)ã€‚
3.  **ä»»åŠ¡æŒ‚èµ·**: AVLT-H æ¨¡å—è§¦å‘ `DelayedRecallSuspension`ï¼Œå¼ºåˆ¶æŒ‚èµ· 20 åˆ†é’Ÿå€’è®¡æ—¶ã€‚
4.  **æ•°æ®åŠ å¯†**: æäº¤æ—¶è°ƒç”¨ `CryptoJS` ç”Ÿæˆ AES-256 å­—ç¬¦ä¸²ã€‚

### 3.3 éšè®¿ä¸ HaaS é—­ç¯ (Follow-up & IoT)
1.  **åŸºçº¿ç¡®ç«‹**: V0 è¡¨å•æäº¤åï¼Œ`AppContext` è®¡ç®— V1-V5 éšè®¿çª—å£æœŸã€‚
2.  **åŒ»å˜±ä¸‹è¾¾**: é¦–é¡µ `MedicalTaskCard` æ¥æ”¶åç«¯æ¨é€çš„â€œè®¾å¤‡ç§Ÿèµâ€åŒ»å˜±ã€‚
3.  **è®¾å¤‡é…å¯¹**: ç”¨æˆ·åœ¨å•†åŸç§Ÿèµè®¾å¤‡ï¼Œ`HomeView` è§¦å‘è“ç‰™é…å¯¹æ¨¡æ‹Ÿã€‚
4.  **å¼‚å¸¸ç›‘æµ‹**: `useIoTSimulation` åå°è¿è¡Œï¼Œæ£€æµ‹åˆ°è·Œå€’/æ£˜æ…¢æ³¢æ—¶è§¦å‘ `GlobalSOS`ã€‚

---

## 4. å®¡è®¡åˆè§„æ€§ (Compliance Audit)

| å®¡è®¡é¡¹ | å®ç°æ–¹æ¡ˆ | çŠ¶æ€ |
| :--- | :--- | :--- |
| **CRF æ ‡å‡†åŒ–** | ä¸¥æ ¼éµå¾ª ILAE 2017 (ç™«ç—«) åŠ Washington CDR (è®¤çŸ¥) æ ‡å‡† | âœ… |
| **æ•°æ®éšç§** | èº«ä»½è¯/æ‰‹æœºå·å‰ç«¯è„±æ•ï¼Œæ ¸å¿ƒç—…å† AES-256 åŠ å¯†å­˜å‚¨ | âœ… |
| **åŒ»ç–—å…è´£** | é¦–é¡µåº•éƒ¨ã€æµ‹è¯„é¡µã€æŠ¥å‘Šé¡µå‡åŒ…å«é†’ç›®çš„å…è´£å£°æ˜ | âœ… |
| **ç´§æ€¥é¿é™©** | é«˜å±çŠ¶æ€ä¸‹ (Risk>60) å¼ºåˆ¶å¼¹çª—æé†’å°±åŒ»ï¼Œæä¾› SOS ä¸€é”®å‘¼å« | âœ… |
| **MOH ç†”æ–­** | `DigitalPrescription` æ‹¦æˆª 24h å†… >3 æ¬¡ç”¨è¯è¯·æ±‚ | âœ… |
| **åŒç›²è¯„ä¼°** | CDR è¯„ä¼°å¼ºåˆ¶åŒºåˆ†çŸ¥æƒ…è€… (`_informant`) ä¸å—è¯•è€… (`_subject`) è§†è§’ | âœ… |

---

## 5. ç‰ˆæœ¬ä¿¡æ¯ (Version Info)
*   **System Version**: Neuro-Link v2.4.0 (Clinical Research Edition)
*   **Build Date**: 2024-05-22
*   **Tech Stack**: React 18, TypeScript 5, Tailwind CSS, Google Gemini SDK
